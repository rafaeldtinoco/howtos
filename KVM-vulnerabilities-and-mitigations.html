<html>

<head>
  <title>QEMU vulnerabilities and mitigations explained</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <style>
    html {
      width: 1024px;
    }

    * {
      font-family: Fantasque Sans Mono, monospace;
      font-size: 18px;
      line-height: 1;
    }
  </style>
</head>

<body>
  <div>
    <span>
      <div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>Introduction</font>
          </span></div>
        <hr />
        <div style="text-align: center;">
          <br>
        </div>
        <div>
          <font>This document should be read together with the following articles:</font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown">
                <font>Security Team Spectre (Variant 1 and 2) and Meltdown (Variant 3)
                  Knowledge Base Article</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/LazyFP">
                <font>Security Team Lazy Floating Point Knowledge Base Article (LazyFP)</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BCBS">
                <font>Security Team Bounds Check Bypass Store Article (Spectre 1.1 / BCBS)
                </font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Variant4">
                <font>Security Team Variant 4 Knowledge Base Article (Variant 4)</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF">
                <font>Security Team L1TF Knowledge Base Article (L1TF)</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS">
                <font>Security Team MDS Knowledge Base Article (MDS)</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/MitigationControls">
                <font>Security Team Mitigation Controls Knowledge Base Article</font>
              </a></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font>And the references used here are, among the documents above, the following
            docs:</font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <li>
            <div><a
                href="https://software.intel.com/security-software-guidance/api-app/sites/default/files/336996-Speculative-Execution-Side-Channel-Mitigations.pdf">
                <font>Intel Speculative Execution Side Channel Mitigations (Rev 3.0)</font>
              </a></div>
          </li>
          <li>
            <div><a
                href="https://software.intel.com/security-software-guidance/api-app/sites/default/files/336983-Intel-Analysis-of-Speculative-Execution-Side-Channels-White-Paper.pdf">
                <font>Intel Analysis of Speculative Execution Side Channels (Rev 4.0)</font>
              </a></div>
          </li>
          <li>
            <div><a
                href="https://software.intel.com/security-software-guidance/insights/deep-dive-mitigation-overview-side-channel-exploits-linux">
                <font>Intel Deep Dive Mitigation Overview Side Channel Exploits Linux</font>
              </a></div>
          </li>
          <li>
            <div><a
                href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-l1-terminal-fault">
                <font>Intel Deep Dive Analysis for L1 Terminal Fault</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://software.intel.com/security-software-guidance/software-guidance/l1-terminal-fault">
                <font>Intel Software Guidance for L1 Terminal Fault</font>
              </a></div>
          </li>
          <li>
            <div><a
                href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling">
                <font>Intel Deep Dive Analysis Microarchitectural Data Sampling</font>
              </a></div>
          </li>
          <li>
            <div><a
                href="https://software.intel.com/en-us/articles/using-intel-compilers-to-mitigate-speculative-execution-side-channel-issues">
                <font>Using Intel Compilers to Mitigate Speculative Execution Side Channel
                  Issues</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation">
                <font>Wikipedia: Kernel Page-Table Isolation</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://en.wikipedia.org/wiki/Lazy_FP_state_restore" style="text-decoration: underline;">
                <font>Wikipedia: Lazy FP state restore</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://www.qemu.org/2018/01/04/spectre/">
                <font>QEMU Spectre and Meltdown Update</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://www.qemu.org/2018/02/14/qemu-2-11-1-and-spectre-update/">
                <font>QEMU Spectre and Meltdown New Update</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://www.berrange.com/posts/2018/06/29/cpu-model-configuration-for-qemu-kvm-on-x86-hosts/">
                <font>Berrange CPU Model Configuration for QEMU/KVM on X86 hosts</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">
                <font>Kernel Admin Guide on HW vulnerabilities - MDS</font>
              </a></div>
          </li>
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html">
                <font>Kernel Admin Guide on HW vulnerabilities - MDS</font>
              </a></div>
          </li>
        </ul>
        <div style="text-align: center;">
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div style="text-align: center;">
            <font><b>How to read this document ?</b></font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>If it is written in <b>black</b>, you should read.
            </font>
          </div>
          <div>
            <font>If it is in <b>
                <font color="#A8A8A8">gray</font>
              </b>, it means it is extra information.</font>
          </div>
          <div>
            <font>If it is in <b>
                <font color="#FF0000">red</font>
              </b>, it is a CPU vulnerability.</font>
          </div>
          <div>
            <font>If it is in <b>
                <font color="#4DCE1D">green</font>
              </b>, it is a mitigation technique.</font>
          </div>
          <div>
            <font>If it is in <b>
                <font color="#A600C4">magenta</font>
              </b>, it is a CPU flag to advertise Kernel and/or Hypervisor.</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font><b>Notes: </b></font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>
              <font>1) Sometimes the mitigation name is the acronym for the CPU flag, example: </font>
              <font color="#4DCE1D">Indirect Branch Prediction Barrier</font> (<b>
                <font color="#A600C4">ibpb</font>
              </b>). And sometimes some CPU flag might mitigate more than 1 vulnerability.
            </font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>2) Downloading the HTML from the wiki (through the
              proper Download link at the top) and opening it locally will make it better for reading (no CSS themes).
              You can also print it to PDF if you'd like.</font>
          </div>
        </div>
        <div style="text-align: center;">
          <br>
        </div>
        <div>
          <font>Also, do check articles dates and look for newer ones not yet updated in this
            document. Newer side channel attack techniques might have been discovered by the time this page was created.
            If you feel this page should be updated, please send us an e-mail at: <a
              href="mailto:ubuntu-server@lists.ubuntu.com">ubuntu-server@lists.ubuntu.com</a> mentioning what should be
            updated and why.</font>
        </div>
        <div>
          <br>
        </div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>Related CPU Vulnerabilities (CVEs)</font>
          </span></div>
        <hr />
        <div>
          <br>
        </div>
        <ol>
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Spectre and Meltdown</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5753.html">CVE-2017-5753</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Bounds Check Bypass (Variant 1 / Spectre)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5715.html">CVE-2017-5715</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Branch Target Injection (Variant 2 / Spectre)</a></font>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5754.html">CVE-2017-5754</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Rogue Data Cache Load (Variant 3 / Meltdown)</a></font>
        </div>
        <div>
          <br>
        </div>
        <ol start="2">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Others</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3665.html">CVE-2018-3665</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/LazyFP" style="color: rgb(255, 0, 0);">Lazy FP
              Save/Restore (LazyFP)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3693.html">CVE-2018-3693</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BCBS" style="color: rgb(255, 0, 0);">Bounds
              Check
              Bypass Store (Variant (or Spectre) 1.1 and 1.2 / BCBS)</a></font>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3640.html">CVE-2018-3640</a>
            - <span style="color: rgb(255, 0, 0);">Rogue System Register Read (RSRE / Variant 3a)</span></font>
        </div>
        <div>
          <font>d) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3639.html">CVE-2018-3639</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Variant4"
              style="color: rgb(255, 0, 0);">Speculative Store Bypass (SSB / Variant 4 / Spectre-NG)</a></font>
        </div>
        <div>
          <br>
        </div>
        <ol start="3">
          <li>
            <div><span style="font-weight: bold;">
                <font>L1 Terminal Fault (L1TF)</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3615.html">CVE-2018-3615</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Intel SGX
              (Software Guard Extensions) (Foreshadow / L1TF)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3620.html">CVE-2018-3620</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Operating
              Systems and System Management Mode (Fault-OS / SMM) (L1TF)</a></font>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3646.html">CVE-2018-3646</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0);">Virtualization Extensions (L1TF)</a></font>
        </div>
        <div>
          <br>
        </div>
        <ol start="4">
          <li>
            <div><span style="font-weight: bold;">
                <font>Microarchitectural Data Sampling (MDS)</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12126.html">CVE-2018-12126</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Store Buffer Data Sampling (MSBDS / Fallout)</a></font>
        </div>
        <div>
          <font>b) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12127.html">CVE-2018-12127</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Load Port Data Sampling (MLPDS / RIDL)</a></font>
        </div>
        <div>
          <font>c) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12130.html">CVE-2018-12130</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Fill Buffer Data Sampling (MFBDS / ZombieLoad)</a>
          </font>
        </div>
        <div>
          <font>d) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-11091.html">CVE-2019-11091</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Data Sampling Uncacheable Memory (MDSUM)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>This same &quot;per CVE&quot; structure is used in all subsequent sections of
            this document.</font>
        </div>
        <div>
          <font>The idea is to allow reader to map: </font>
        </div>
        <div style="text-align: center;">
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div style="text-align: center;">
            <font>CPU Vulnerability    &lt;-&gt;    Firmware/Kernel/OS
              Mitigation    &lt;-&gt;    CPU Flags to Guest</font>
          </div>
        </div>
        <div style="text-align: center;">
          <br>
        </div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>CPU Vulnerabilities, HW / Firmware, Kernel and OS Mitigations</font>
          </span></div>
        <hr />
        <div>
          <br>
        </div>
        <ol>
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Spectre and Meltdown</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5753.html">CVE-2017-5753</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Bounds Check Bypass (Variant 1 / Spectre)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Spectre Variant 1 targets 'conditional branch instructions'. <span
              style="color: rgb(168, 168, 168);">The operating system uses conditional branches for processing and
              validating virtually all data, including untrusted data processed by the kernel. Even code appearing
              “correct” can potentially be exploited to gain unauthorized access to information.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">a.1) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-mitigation-overview-side-channel-exploits-linux"
              style="color: rgb(77, 206, 29); font-style: italic;">__user pointer sanitization</a></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>To mitigate this exploit technique in the Linux kernel, we first identify
              instruction sequences that can be tricked into exploitable behavior. Since a sequence must fit a specific
              pattern and operate on untrusted data before any potential exploit, not all conditional branches are
              exploitable. Techniques such as static analysis or manual inspection can identify these sequences.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5715.html">CVE-2017-5715</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Branch Target Injection (Variant 2 / Spectre)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The branch target injection exploit targets a processor’s 'indirect branch
            predictor'. <span style="color: rgb(168, 168, 168);">Indirect branches are used very differently than the
              conditional branches that the first exploit may target. In Linux, indirect branches are used relatively
              rarely compared to conditional branches, but they are used in critical locations. In addition, the
              compiler may insert indirect branches without the programmer ever being aware. </span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Since the compiler generates these
              branches, mitigation against this exploit is the most straightforward when the compiler can simply avoid
              generating vulnerable branch sequences.</span> A software construct called <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/TechFAQ#Retpoline"
              style="color: rgb(0, 0, 238);">retpoline</a> can be deployed to help ensure that a given indirect branch
            is resistant to exploitation. The compiler, automatically, or the programmer, manually, can insert the
            retpoline logic in binary code. <span style="color: rgb(168, 168, 168);">Retpoline deliberately steer the
              processor’s branch prediction logic to a trusted location, preventing a potential exploit from steering
              them elsewhere.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.1)</span> <span style="font-style: italic;">OS and Kernel
              Mitigation: </span><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/TechFAQ#Retpoline"
              style="color: rgb(77, 206, 29); font-style: italic;">Retpoline</a></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Retpoline needs code (kernel and/or userland) to be recompiled by a compiler
            with this feature enabled. If not using retpoline, firmware microcode might ALSO mitigate against Spectre
            Variant 2 on several different platforms. </font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2) </span><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown#Processor_Firmware_Availability"
              style="color: rgb(0, 0, 0); font-style: italic;">Firmware Mitigations</a><span
              style="font-style: italic;">:</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>for Spectre Variant 2 are also provided by different CPU microcodes. Taking
            amd64 by example, there are MORE THAN 1 mitigation included in more recent microcodes AND about to (or
            being, or recently done) be included in newer CPUs internal logic.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2.1)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Enhanced Indirect Branch Restricted Speculation
              (IBRS)</span><span style="font-style: italic;">: Restricts speculation of indirect branches.</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>With enhanced IBRS, the predicted targets of indirect branches executed
              cannot be controlled by software that was executed in a less privileged predictor mode or on another
              logical processor. As a result, software operating on a processor with enhanced IBRS need not use WRMSR to
              set IA32_SPEC_CTRL.IBRS after every transition to a more privileged predictor mode. Software can isolate
              predictor modes effectively simply by setting the bit once.</font>
          </span></div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2.2)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Single Thread Indirect Branch Predictors
              (STIBP)</span><span style="font-style: italic;">: Prevents indirect branch predictions from being
              controlled by the sibling HW thread.</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>STIBP is an indirect branch control mechanism that restricts the sharing of
              branch prediction between logical processors on a core. ... as  the logical processors sharing a core may
              share indirect branch predictors, allowing one logical processor to control the predicted targets of
              indirect branches by another logical processor of the same core</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font><span style="color: rgb(168, 168, 168);">Enabling IBRS prevents software
              operating on one logical processor from controlling the predicted targets of indirect branches executed on
              another logical processor. For that reason,</span> <span
              style="color: rgb(168, 168, 168); text-decoration: underline;">it is not necessary to enable STIBP when
              IBRS is enabled.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2.3)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Indirect Branch Predictor Barrier (IBPB)</span><span
              style="font-style: italic;">: Ensures earlier code's behavior does not control later indirect branch
              predictions. Complements Enhanced IBRS.</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>IBPB is an indirect branch control mechanism that establishes a barrier,
              preventing software that executed before the barrier from controlling the predicted targets of indirect
              branches executed after the barrier on the same logical processor. A processor supports IBPB if it
              enumerates CPUID.(EAX=7H,ECX=0):EDX[26] as 1.</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>IBPB does not define a new mode of processor operation that controls the
              branch predictors, unlike Indirect Branch Restricted Speculation (IBRS) and Single Thread Indirect Branch
              Predictors (STIBP). As a result, it is not enabled by setting a bit in the IA32_SPEC_CTRL MSR. Instead,
              IBPB is a “command” that software executes when necessary.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5754.html">CVE-2017-5754</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Rogue Data Cache Load (Variant 3 / Meltdown)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The rogue data cache load exploit targets a processor’s speculative data
            loading mechanisms. Even though the processor’s access control may protect a piece of data, it may still be
            read speculatively before an illegal access is determined to exist. The first two exploits require
            manipulating the kernel to do something for an attacker, while this exploit occurs entirely within code
            which is under the control of an attacker. This means we cannot modify the kernel to mitigate this exploit,
            we must fundamentally change where kernel data is available.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">c.1) Kernel Mitigation: </span><a
              href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation"
              style="color: rgb(77, 206, 29); font-style: italic;">Kernel Page Table Isolation</a></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>The mitigation for this is conceptually very simple: instead of relying on a
              processor’s access-control mechanisms to protect data, simply remove the data instead.</font>
          </span></div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font><span style="color: rgb(168, 168, 168);">In Linux, this mitigation is referred
              to as Kernel Page Table Isolation (PTI). This mitigation removes the data from the reach of exploits by
              having the kernel maintain two independent copies of the</span> <span
              style="color: rgb(168, 168, 168); text-decoration: underline;">hardware page tables</span><span
              style="color: rgb(168, 168, 168);">. One copy contains the minimal set of data and code needed to run an
              application and enter or exit the kernel, but it does not contain valuable kernel data. The other set of
              page tables, active only while the kernel is running, contains everything needed for the kernel to
              function normally, including its private data.</span></font>
        </div>
        <div>
          <br>
        </div>
        <ol start="2">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Others</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3665.html">CVE-2018-3665</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/LazyFP" style="color: rgb(255, 0, 0);">Lazy FP
              Save/Restore (LazyFP)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Lazy FPU state leak, or Lazy FP State Restore, or LazyFP, affects only Intel
            Core CPUs. <span style="color: rgb(168, 168, 168);">It is a combination of flaws in the speculative
              execution technology presented in some CPUs, and how certain the OS handle context switching on the
              floating point unit.</span> Basically a local process can leak the content of the FPU register to another
            process. </font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">a.1)</span> <span style="font-style: italic;">Kernel Mitigation</span>
          </font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Intel recommends OS to use <a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00145.html"
              style="color: rgb(77, 206, 29);">Eager FP state restore</a> in lieu of Lazy FP state restore. Linux Kernel
            does that since kernel 4.5. Older kernels running on processors that support the xsaveopt instruction are
            also not affected. You can verify if your system has support for xsaveopt by locating the &quot;<span
              style="color: rgb(166, 0, 196); font-weight: bold;">xsaveopt</span>&quot; feature listed in the flags
            section of the /proc/cpuinfo file. No particular mitigation for QEMU/KVM.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3693.html">CVE-2018-3693</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BCBS" style="color: rgb(255, 0, 0);">Bounds
              Check
              Bypass Store (Variant (or Spectre) 1.1 and 1.2 / BCBS)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Many Intel processors use memory
              disambiguation predictors that allows loads to be executed </span><span
              style="color: rgb(168, 168, 168);">speculatively before it is known whether the load’s address overlaps
              with a preceding store’s address. This may happen if a store’s address is unknown when the load is ready
              to execute. If the processor predicts that the load address will not overlap with the unknown store
              address, the load may execute speculatively. However, if there was indeed an overlap, then the load may
              consume stale data. When this occurs, the processor will re-execute the load to ensure a correct
              result.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Through the memory disambiguation predictors, an attacker can cause certain
            instructions to be executed speculatively and then use the effects for side channel analysis.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>b.1) Software Based Mitigations</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.1.1)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Process Isolation</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font>To run untrusted code in different processes, so the address space is not
            shared among trusted and untrusted code.</font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font><span style="font-style: italic;">b.1.2)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">LFENCE</span> <span
              style="font-style: italic;">(requires new firmware/microcode)</span></font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font>Software can <a
              href="https://software.intel.com/en-us/articles/using-intel-compilers-to-mitigate-speculative-execution-side-channel-issues">insert
              a LFENCE between a store and a subsequent load</a> to prevent the load from executing before the previous
            store's address is known. This should be applied only in places with realistic risk, as it incurs in
            performance penalty.</font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2) Firmware Mitigation:</span> <span
              style="color: rgb(77, 206, 29);">Speculative Store Bypass Disable (SSBD)</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3640.html">CVE-2018-3640</a>
            - <span style="color: rgb(255, 0, 0);">Rogue System Register Read (RSRE / Variant 3a)</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The rogue system register read method, uses both speculative execution and side
            channel cache methods to infer the value of some processor system register state which is not
            architecturally accessible by the attacker. <span style="color: rgb(168, 168, 168);">T</span><span
              style="color: rgb(168, 168, 168);">his method uses speculative execution of instructions that read system
              register state while the processor is operating at a mode or privilege level that does not architecturally
              allow the reading of that state. The set of system registers that can have their value inferred by this
              method is implementation-specific.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Intel’s analysis is that the majority of state exposed by the Variant 3a method
            is not secret or sensitive, nor directly enables attack or exposure of user data. <span
              style="color: rgb(168, 168, 168);">The use of the Variant 3a method by an attacker may result in the
              exposure of the physical addresses for some data structures and may also expose the linear addresses of
              some kernel software entry points.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>Knowledge of these physical and linear addresses may enable attackers to
              determine the addresses of other kernel data and code elements, which may impact the efficacy of the
              Kernel Address Space Layout Randomization (KASLR) technique.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">c.1) Firmware Mitigation:</span> <a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00115.html"
              style="color: rgb(77, 206, 29);">Speculative Store Bypass Disable (SSBD)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>d) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3639.html">CVE-2018-3639</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Variant4"
              style="color: rgb(255, 0, 0);">Speculative Store Bypass (SSB / Variant 4 / Spectre-NG)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The speculative store bypass method takes advantage of a performance feature
            present in many high performance processors that allows loads to speculatively execute even if the address
            of preceding potentially overlapping store is unknown. In such a case, this may allow a load to
            speculatively read a stale data value. The processor will eventually correct such cases, but an attacker may
            be able to discover “confused deputy” code which may allow them to use speculative execution to reveal the
            value of memory that is not normally accessible to them.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>d.1) <span style="font-style: italic;">OS and Firmware Mitigation:</span> <a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00115.html"
              style="color: rgb(77, 206, 29);">Speculative Store Bypass Disable (SSBD)</a></font>
        </div>
        <div style="margin-left: 80px;"></div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>SSBD prevents a load from executing speculatively until the address of all
            older stores are known. In Ubuntu, SSBD is OFF by default because it is not needed by most programs and
            carries a notable performance impact. <span style="color: rgb(168, 168, 168);">A prctl() has been added
              (PR_SPEC_STORE_BYPASS) that enables developers to opt into the mitigation on a per process basis.</span>
          </font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Applications using seccomp filters will be implicitly opted into the
            mitigations (snaps, processes inside LXD containers, sandboxed firefox and chromium processes, will have
            SSBD mitigation enabled out of the box).</font>
        </div>
        <div>
          <br>
        </div>
        <ol start="3">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html"
                style="font-weight: bold;">
                <font>L1 Terminal Fault (L1TF)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>When a program attempts to access data in memory, the logical memory address is
            translated to a physical address by the hardware. Accessing a logical or linear address that is not mapped
            to a physical location on the hardware will result in a terminal fault. </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Once the fault is triggered, there is a gap, before resolution, where the
            processor will use speculative execution to try to load data. During this time, the processor could
            speculatively access the level 1 data cache (L1D), potentially allowing side-channel methods to infer
            information that would otherwise be protected.  </font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>Because the resulting probed physical address is not a true translation of
              the virtual address, the resulting address is not constrained by various memory range checks or nested
              translations. Specifically:</font>
          </span></div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>- Intel SGX protected memory checks are not applied.</font>
          </span></div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>- Extended Page Table guest physical to host physical address translation is
              not applied.</font>
          </span></div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>- SMM protected memory checks are not applied.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;"><span style="font-style: italic;">
            <font>Mitigations bellow server for different L1TF vulnerabilities sub-types.
            </font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">3.1) Using Newer CPUs or
              Firmware:</span><span style="color: rgb(77, 206, 29); font-style: italic;"> </span><span
              style="color: rgb(77, 206, 29); font-style: italic;">C</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">heck</span> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-l1-terminal-fault"
              style="color: rgb(77, 206, 29); font-style: italic;">Intel Documentation</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">3.2) Kernel Mitigation:</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Removing Secrets from L1D</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>Data that might be leaked by an L1TF exploit must be present in the L1D while
            malicious code executes. When transitioning to less-privileged code, removing data from the L1D mitigates
            exploits that might be launched in the less-privileged code.</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="font-style: italic;">
            <font>3.3) Page Table Entries Inversion</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>OS is responsible for mitigating against exploitation of paging structure
            entries by malicious applications. To do this, the OS can ensure that vulnerable Page Table Entries (PTEs)
            refer only to specifically-selected physical addresses, such as those addresses outside of available cached
            memory or addresses that do not contain secrets.</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>There are four typical cases that need mitigation in an OS:</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;">
          <font color="#A8A8A8" style="font-size: 11pt;"><br /></font>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>3.2.1) Pages with no valid mappings.</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>3.2.2) Pages that have been written to other storage (swapped out)</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>3.2.3) Pages where the application has requested that the OS disable access.
            </font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>3.2.4) Pages in transitional states where the OS needs to temporarily block
              access.</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;">
          <font color="#A8A8A8" style="font-size: 11pt;"><br /></font>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>In the first case, OSes may use an all-zero paging structure entry to
              represent linear addresses with no physical mapping (including the Page Size Extension (PSE) bit7 where
              supported) while ensuring that the 4 KB page frame starting at physical address 0 contains no secrets.
            </font>
          </span></div>
        <div>
          <font color="#A8A8A8" style="font-size: 11pt;"><br /></font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font><span style="color: rgb(168, 168, 168);">For the other three cases, the OS
              should make the PTEs refer to invalid memory addresses, as described in the following sections.</span>
          </font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font><span style="font-weight: bold;">Disabling EPT for virtual machines provides
              full mitigation for L1TF even with SMT enabled</span>, because the effective page tables for guests are
            managed and sanitized by the hypervisor. Though disabling EPT has a significant performance impact
            especially when the Meltdown mitigation KPTI is enabled.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="font-style: italic;">
            <font>3.4) SMT Disablement</font>
          </span></div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-weight: bold;">To prevent the SMT issues of L1TF it might be
              necessary to disable SMT completely.</span> Disabling SMT can have a significant performance impact, but
            the impact depends on the hosting scenario and the type of workloads. The impact of disabling SMT needs also
            to be weighted against the impact of other mitigation solutions like confining guests to dedicated cores.
          </font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3615.html">CVE-2018-3615</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Intel SGX
              (Software Guard Extensions) (Foreshadow / L1TF)</a></font>
        </div>
        <div>
          <font>(does not affect Ubuntu)</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>The enclave-to-enclave (E2E) method is a sub-variant of the L1TF method. E2E
              may expose memory in one Intel SGX enclave to software that is running in a different Intel SGX enclave on
              the same core.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;"><span style="color: rgb(77, 206, 29); font-style: italic;">
            <font>a.1) No mitigation needed for Ubuntu Linux,</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3620.html">CVE-2018-3620</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Operating
              Systems and System Management Mode (Fault-OS / SMM) (L1TF)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>SMM is a special processor mode used by BIOS. SMM software must rendezvous all
            logical processors both on entry to, and exit from, SMM to ensure that a sibling logical processor does not
            reload data into the L1D after the automatic flush. We believe most SMM software already does this. This
            will ensure that non-SMM software does not run while lines that belong to SMM are in the L1D. Such SMM
            implementations do not require any software changes to be fully mitigated for L1TF. </font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b</span><span style="font-style: italic;">.1)
              Using Newer CPUs or Firmware:</span><span
              style="color: rgb(77, 206, 29); font-style: italic;"> </span><span
              style="color: rgb(77, 206, 29); font-style: italic;">C</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">heck</span> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-l1-terminal-fault"
              style="color: rgb(77, 206, 29); font-style: italic;">Intel Documentation</a></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>The SMRR MSRs are used to protect <span style="font-weight: bold;">SMM</span>
            and will prevent non-<span style="font-weight: bold;">SMM</span> code from bringing SMM lines into the L1D.
            Processors that enumerate <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> and are
            affected by <span style="font-weight: bold; color: rgb(255, 0, 0);">L1TF</span> will automatically flush the
            <span style="font-weight: bold;">L1D</span> during the RSM instruction that exits <span
              style="font-weight: bold;">SMM</span>.
          </font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">b.2) Check item (3.3):</span> <span style="font-style: italic;">Kernel
              Mitigation:</span> <span style="color: rgb(77, 206, 29); font-style: italic;">Removing Secrets from
              L1D</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>An updated kernel removes the possibility for unintended memory exposure
            between processes within the same operating system environment by adjusting page table entries for
            not-present pages to point to uncacheable memory. The mitigation for this vulnerability introduces
            negligible performance impacts.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3646.html">CVE-2018-3646</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0);">Virtualization Extensions (L1TF)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <div></div>
        <div>
          <font>This issue only affects virtualization hypervisors and does not impact systems
            where virtualization is not used. Anything mentioned here is specific to KVM in the Linux Kernel.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Processors that implement Intel HT share the L1D between all logical processors
            (hyperthreads) on the same physical core. This means that data loaded into the L1D by one logical processor
            may be speculatively accessed by code running on another logical processor. Disabling hyperthreading does
            not in itself provide mitigation for L1TF.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">c.1) Check item (3.3):</span> <span style="font-style: italic;">Kernel
              Mitigation:</span> <span style="color: rgb(77, 206, 29); font-style: italic;">Removing Secrets from
              L1D</span></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>An updated kernel will flush the L1 data cache in some specific scenarios when
            the host enters the guest. Flushing the L1 data cache is an expensive operation that negates the performance
            improvements of caching so flushing the L1 data cache is performed selectively to protect certain code paths
            that could cause unintended memory exposure to a malicious guest.</font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Optimized L1 data cache flushing is available via intel-microcode updates
            (<span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span>capability). The updated kernels
            implement a software fallback cache flushing mechanism for processors that have not received microcode
            updates.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>When guests are trusted or belong to the same security domain, no mitigation
              is needed. However, VMMs generally allow untrusted guests to place arbitrary translations in the guest
              paging structure entries because VMMs assume any entries will be translated with VMM-controlled EPT. But
              EPT translation is not performed in the case of an L1 terminal fault.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;"><span style="color: rgb(168, 168, 168);">
            <font>This means a malicious guest OS may be able to set up values in its paging
              structure entries that attack arbitrary host addresses, theoretically enabling an exploit to access any
              data present in the L1D on the same physical core as the malicious guest. For this reason, VMM mitigations
              are focused on ensuring secret data is not present in the L1D when executing guests.</font>
          </span></div>
        <div>
          <br>
        </div>
        <ol start="4">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html"
                style="font-weight: bold;">
                <font>Microarchitectural Data Sampling (MDS)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>This vulnerability affects a wide range of Intel processors.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>It was discovered that memory contents previously stored in microarchitectural
            buffers of an Intel CPU core may be exposed to a malicious process that is executing on the same CPU core
            via a speculative execution side-channel. A local attacker could access the stale contents of store buffers,
            load ports, and fill buffers which may contain data belonging to another process or data that originated
            from a different security context. As a result, unintended memory exposure can occur between userspace
            processes, between the kernel and userspace, between virtual machines, or between a virtual machine and the
            host environment.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>MDS differs from other recent speculative execution side-channel attacks in
              that the attacker cannot target specific data. The attacker can periodically sample the contents in the
              buffers but does not have control over the data that is present in the buffers when the sample is taken.
              Therefore, additional work is required to fully collect and reconstruct the data into a meaningful data
              set.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>The mitigation for microarchitectural data sampling issues includes clearing
              store buffers, fill buffers, and load ports before transitioning to possibly less privileged execution
              entities.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12126.html">CVE-2018-12126</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Store Buffer Data Sampling (MSBDS / Fallout)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>When performing store operations, processors write data into a temporary
            microarchitectural structure called the store buffer. This enables the processor to continue to execute
            instructions following the store operation, before the data is written to cache or main memory. I/O writes
            (for example, OUT) are also held in the store buffer.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>When a load operation reads data from the same memory address as an earlier
            store operation, the processor may be able to forward data to the load operation directly from the store
            buffer instead of waiting to load the data from memory or cache. This optimization is called store-to-load
            forwarding.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Under certain conditions, data from a
              store operation can be speculatively forwarded from the store buffer to a faulting or assisting load
              operation for a different memory address. </span><span style="color: rgb(168, 168, 168);">It is possible
              that a store does not overwrite the entire data field within the store buffer due to either the store
              being a smaller size than the store buffer width, or not yet having executed the data portion of the
              store. These cases can lead to data being forwarded that contains data from older stores. Because the load
              operation will cause a fault/assist and its results will be discarded, the forwarded data does not result
              in incorrect program execution or architectural state changes. However, malicious actors may be able to
              forward this speculative-only data to a disclosure gadget in a way that allows them to infer this
              value.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12127.html">CVE-2018-12127</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Load Port Data Sampling (MLPDS / RIDL)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Processors use microarchitectural structures called load ports to perform load
            operations from memory or I/O. During a load operation, the load port receives data from the memory or I/O
            system, and then provides that data to the register file and younger dependent operations. In some
            implementations, the writeback data bus within each load port can retain data values from older load
            operations until younger load operations overwrite that data. Since speculatively executed load operations
            may receive stale data values from the store buffer or fill buffer, the retained values may also hold store
            values.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>c) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12130.html">CVE-2018-12130</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Fill Buffer Data Sampling (MFBDS / ZombieLoad)</a>
          </font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>A fill buffer is an internal structure used to gather data on a first level
              data cache miss. When a memory request misses the L1 data cache, the processor allocates a fill buffer to
              manage the request for the data cache line. The fill buffer also temporarily manages data that is returned
              or sent in response to a memory or I/O operation. Fill buffers can forward data to load operations and
              also write data to the data cache. Once the data from the fill buffer is written to the cache (or
              otherwise consumed when the data will not be cached), the processor deallocates the fill buffer, allowing
              that entry to be reused for future memory operations.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>Fill buffers may retain stale data from prior memory requests until a new
            memory request overwrites the fill buffer. Under certain conditions, the fill buffer may speculatively
            forward data, including stale data, to a load operation that will cause a fault/assist. This does not result
            in incorrect program execution because faulting/assisting loads never retire and therefore do not modify the
            architectural state. However, a disclosure gadget may be able to infer the data in the forwarded fill buffer
            entry through a side channel timing analysis.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>d) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-11091.html">CVE-2019-11091</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Data Sampling Uncacheable Memory (MDSUM)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Data accesses that use the uncacheable (UC) memory type do not fill new lines
            into the processor caches. On processors affected by Microarchitectural Data Sampling Uncachable Memory
            (MDSUM), load operations that fault or assist to uncacheable memory may still speculatively see the data
            value from those core or data accesses. Because uncacheable memory accesses still move data through store
            buffers, fill buffers, and load ports, and those data values may be speculatively returned on faulting or
            assisting loads, malicious actors can observe these data values through the MSBDS, MFBDS, and MLPDS
            mechanisms discussed above.</font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <li>
            <div><span style="font-weight: bold;">
                <font>Mitigations for (a), (b), (c) and (d):</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font>The vulnerability is <span style="font-weight: bold;">NOT</span> present on:
          </font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <ul>
            <li>
              <div>
                <font>Processors from AMD, Centaur and other non Intel vendors</font>
              </div>
            </li>
            <li>
              <div>
                <font>Older processor models, where the CPU family is &lt; 6</font>
              </div>
            </li>
            <li>
              <div>
                <font>Some Atoms (Bonnell, Saltwell, Goldmont, GoldmontPlus)</font>
              </div>
            </li>
            <li>
              <div>
                <font>Intel processors w/ <span
                    style="font-weight: bold; color: rgb(166, 0, 196);">ARCH_CAP_MDS_NO</span> bit set in the <span
                    style="font-weight: bold; color: rgb(166, 0, 196);">IA32_ARCH_CAPABILITIES</span> MSR.</font>
              </div>
            </li>
          </ul>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">CASE 01) </span><span
              style="font-weight: bold; text-decoration: underline;">Non SMT (Simultaneous Multithreading)
              CPUs</span><span style="font-weight: bold;">:</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>There are two methods to overwrite the microarchitectural buffers affected by
            MDS: <span style="font-weight: bold; color: rgb(166, 0, 196);">MD_CLEAR</span> functionality and software
            sequences.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">4.1) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;">Using Newer CPUs or Firmware</a></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Through IA32_ARCH_CAPABILITIES MSR it is possible to see if the current CPU has
            the <span style="font-weight: bold; color: rgb(77, 206, 29);">RDCL_NO</span> (Not susceptible to Rogue Data
            Cache Load) feature. If it has, then the processor is also not affected by <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MFBDS</span>.</font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Recently IA32_ARCH_CAPABILITIES MSR was expanded to sinalize the <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MDS_NO</span> feature. A value of 1 indicates that
            processor is not affected by <span
              style="font-weight: bold; color: rgb(255, 0, 0);">MFBDS/MSBDS/MLPDS/MDSUM</span>.</font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Note that <span style="font-weight: bold; color: rgb(255, 0, 0);">MFBDS</span>
            is mitigated if either the <span style="font-weight: bold; color: rgb(77, 206, 29);">RDCL_NO</span> or <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MDS_NO</span> bit (or both) are set. Some existing
            processors may also enumerate either <span
              style="font-weight: bold; color: rgb(77, 206, 29);">RDCL_NO</span> or <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MDS_NO</span>only after a microcode update is loaded.
          </font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Intel will release microcode updates and new processors that enumerate <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span> functionality. On processors that
            enumerate <span style="font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span>, the VERW instruction or
            <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command should be used to cause
            the processor to overwrite buffer values that are affected by <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MDS</span>, as these instructions are preferred to the
            software sequences.
          </font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font><span style="font-style: italic;">4.1.1)</span> <span
              style="font-style: italic; color: rgb(77, 206, 29); font-weight: bold;">MD_CLEAR</span> <span
              style="font-style: italic;">+ QEMU:</span> <span
              style="font-style: italic; font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> <span
              style="font-style: italic;">support when entering vCPU</span></font>
        </div>
        <div style="margin-left: 80px;">
          <div>
            <br>
          </div>
          <div>
            <font>The VMM can execute either the VERW instruction or the <span
                style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command before entering a guest VM.
              This will overwrite protected data in the buffers that could belong to the VMM or other VMs. VMMs that
              already use the <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command before
              entering guest VMs to mitigate L1TF may not need further changes beyond loading a microcode update that
              enumerates MD_CLEAR.</font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font><span style="font-style: italic;">4.1.2)</span> <span
                style="font-style: italic; font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span> <span
                style="font-style: italic;">+ Kernel Mitigations:</span></font>
          </div>
          <div><span style="font-style: italic;">
              <font>VERW instr on ring 0 &lt;-&gt; 3 and c-states transitions</font>
            </span></div>
          <div>
            <br>
          </div>
          <div>
            <font>The OS can execute the VERW instruction to overwrite any protected data in
              affected buffers when transitioning from ring 0 to ring 3. This will overwrite protected data in the
              buffers that could belong to the kernel or other applications.</font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font><span style="font-style: italic; color: rgb(168, 168, 168);">4.1.3)</span>
              <span style="font-style: italic; font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span> <span
                style="font-style: italic; color: rgb(168, 168, 168);">+ System Management Mode (SMM)</span>
            </font>
          </div>
          <div>
            <br>
          </div>
          <div><span style="color: rgb(168, 168, 168);">
              <font>Exposure of system management mode (SMM) data to software that subsequently
                runs on the same logical processor can be mitigated by overwriting buffers when exiting SMM. On
                processors that enumerate MD_CLEAR, the processor will automatically overwrite the affected buffers when
                the RSM instruction is executed.</font>
            </span></div>
          <div>
            <br>
          </div>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">4.2) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic; color: rgb(0, 0, 0);">NO</a> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;"></a><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic; font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</a> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;"></a><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic; color: rgb(0, 0, 0);">+ Software Based Mitigation</a></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>On processors that do not enumerate the <span
              style="font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span> functionality, certain instruction
            sequences may be used to overwrite buffers affected by MDS. These sequences are described in detail in the
            Software sequences to overwrite buffers section.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">CASE 02)</span> <span
              style="font-weight: bold; text-decoration: underline;">For SMT (</span><span
              style="font-weight: bold; text-decoration: underline;">Simultaneous Multithreading) </span><span
              style="font-weight: bold; text-decoration: underline;">capable CPUs</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font><span style="font-style: italic;">4.3) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;">Sibling threads and OS Mitigations</a></font>
        </div>
        <div style="margin-left: 80px;">
          <br>
        </div>
        <div style="margin-left: 80px;">
          <font>Even with <span style="color: rgb(77, 206, 29); font-weight: bold;">MD_CLEAR</span> capable firmwares
            and new CPUs, the OS
            must employ two different methods to prevent a thread from using <span
              style="color: rgb(255, 0, 0); font-weight: bold;">MDS</span> to infer data values used by the sibling
            thread. The first (<span style="font-weight: bold;">group scheduling</span>) protects against user vs. user
            attacks. The second (<span style="font-weight: bold;">synchronized entry</span>) protects kernel data from
            attack when one thread executes kernel code by an attacker running in user mode on the other thread.</font>
        </div>
        <div>
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168); font-style: italic;">
            <font>4.3.1) HW Disable </font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>A HW only method method to prevent the sibling thread from inferring data
              values through MDS is to disable SMT either through the BIOS or by having the OS only schedule work on one
              of the threads.</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168); font-style: italic;">
            <font>4.3.2) Group Scheduling</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>The OS can prevent a sibling thread from running malicious code when the
              current thread crosses security domains. The OS scheduler can reduce the need to control sibling threads
              by ensuring that software workloads sharing the same physical core mutually trust each other (for example,
              if they are in the same application defined security domain) or ensuring the other thread is idle. </font>
          </span></div>
        <div>
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168); font-style: italic;">
            <font>4.3.3) Synchronized Entry</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="color: rgb(168, 168, 168);">
            <font>The OS needs to take action when the current hardware thread makes
              transitions from user code (application code) to the kernel code (ring 0 mode). This can happen as part of
              syscall or asynchronous events such as interrupts, and thus the sibling thread may not be allowed to
              execute in user mode because kernel code may not trust user code.</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;"><span style="font-style: italic;">
            <font>4.3.4) Virtual Machine Manager (VMM)</font>
          </span></div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font>Processors that enumerate <span style="font-weight: bold; color: rgb(77, 206, 29);">MD_CLEAR</span> have
            enhanced the <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command to also
            overwrite the
            microarchitectural structures affected by <span
              style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span>. This can allow VMMs that have mitigated
            <span style="font-weight: bold; color: rgb(255, 0, 0);">L1TF</span> through group scheduling and through
            using the <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command to also
            mitigate MDS. 
          </font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font>The VMM mitigation may need to be applied to processors that are not affected
            by <span style="font-weight: bold; color: rgb(255, 0, 0);">L1TF</span> (<span
              style="font-weight: bold; color: rgb(77, 206, 29);">RDCL_NO</span> is set) but are affected by MDS (MDS_NO
            is clear). VMMs on such processors can use VERW instead of the <span
              style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span> command. </font>
        </div>
        <div style="margin-left: 120px;">
          <br>
        </div>
        <div style="margin-left: 120px;">
          <font>VMMs that have implemented the <span style="font-weight: bold;">L1D
              flush</span> using a software sequence should use a VERW instruction to overwrite microarchitectural
            structures affected by <span style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span>.</font>
        </div>
        <div>
          <br>
        </div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>QEMU/KVM ONLY - Mitigations and CPU Flags</font>
          </span></div>
        <hr />
        <div></div>
        <div>
          <br>
        </div>
        <div>
          <font>In order to protect the guest kernel from a malicious userspace, updates are
            also needed to the guest kernel and, depending on the processor architecture, to QEMU.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>QEMU configures the hypervisor to emulate a specific processor model. For x86,
            QEMU has to be aware of new CPUID bits introduced by the microcode update (next section clarifies CPU
            flags), and it must provide them to guests depending on how the guest is configured.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Once updates are provided, live migration to an updated version of QEMU will
            not be enough to protect guest kernel from guest userspace. Because the virtual CPU has to be changed to one
            with the new CPUID bits, the guest will have to be restarted.</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">CPU features are advertised, by the CPU
              to the OS Kernel, through the CPUID instruction. Depending on how the CPU registers are set, different
              type of information regarding CPU supported features are returned by the CPU itself. To extend the
              capability of receiving more data, than the ones available through the CPU register on the return of the
              instruction, there is also the possibility that some of the return is given through MSRs (Model-Specific
              Registers): memory mapped internal to CPU registers.</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;"><br /></font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">With a specific CPUID instruction,
              available CPU mitigation supportability is reported through a CPU register:</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;"><br /></font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 26: <b>IBRS</b> and <b>IBPB</b> are
              supported (Spectre Variants)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 27: <b>STIBP</b> is supported
              (Spectre Variants)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 28: <b>L1D_FLUSH</b> is supported
              (L1TF)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 29: <b>IA32_ARCH_CAPABILITIES</b>
              supported (will provide the list bellow in a MSR)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 30: -</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 31: <b>SSBD</b> supported (SSB /
              Variant 4)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;"><br /></font>
          </div>
          <div>
            <font style="color: rgb(168, 168, 168); font-size: 11pt;">The MSR
              used for the IA32_ARCH_CAPABILITIES feature, listing other CPU features available for the CPU being
              queried, can list the following CPU features/mitigations:</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;"><br /></font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 00: <b>RDCL_NO</b> (CPU not
              susceptible to RDCL - Rogue Data Cache Load) - Meltdown / Variant 3</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 01: <b>IBRS_ALL</b> (Processor
              supports <u>Enhanced</u> IBRS) - Better/Faster IBRS (less overhead)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 02: <b>RSBA</b> (Processor supports
              RSB Alternate) - Spectre Variant 2 / RSB underflow</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 03: <b>SKIP_L1DFL_VMENTRY</b> (1
              means CPU need not to Flush L1D on vCPU VM Entry)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">Bit 04: <b>SSB_NO</b> (Processor is NOT
              susceptible to SSB Speculative Store Bypass)</font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;"><br /></font>
          </div>
          <div>
            <font color="#A8A8A8" face="Lucida Console" style="font-size: 11pt;">NOTE: Some of the CPU features have the
              same name as the Mitigation Technique being used for the security vulnerability.</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ol style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Spectre and Meltdown</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>QEMU contains the mitigation functionality for x86 guests, along with
            additional mitigation functionality for pseries and s390x guests. Please note that QEMU/KVM has at least the
            same requirements as other unprivileged processes running on the host with <span
              style="text-decoration: underline;">regard to Spectre/Meltdown mitigation</span>. </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>What is being addressed here is enabling a guest operating system to enable the
            same (or similar) mitigations to protect itself from unprivileged guest processes running under the guest
            operating system. </font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <li>
            <div><span style="font-weight: bold;">
                <font>Vulnerabilities (CVEs) &amp; Mitigation Notes</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5753.html">CVE-2017-5753</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Bounds Check Bypass (Variant 1 / Spectre)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">a.1) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-mitigation-overview-side-channel-exploits-linux"
              style="color: rgb(77, 206, 29); font-style: italic;">__user pointer sanitization</a> on both,
            VMM/Hypervisor Kernel &amp; Guest Kernel.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5715.html">CVE-2017-5715</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Branch Target Injection (Variant 2 / Spectre)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>Among the three vulnerabilities, CVE-2017-5715 is notable because it allows
            guests to read potentially sensitive data from hypervisor memory. Patching the host kernel is sufficient to
            block attacks from guests to the host but not from guest user to guest kernel (guest kernel also needs
            mitigation).</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <div>
            <br>
          </div>
        </div>
        <div>
          <font><span style="font-style: italic;">b.1) Host Kernel and KVM: </span><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/TechFAQ#Retpoline"
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">Retpoline</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Ubuntu kernel is compiled with <span
              style="font-weight: bold; color: rgb(77, 206, 29);">retpoline</span> support.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.2) </span><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown#Processor_Firmware_Availability"
              style="color: rgb(0, 0, 0); font-style: italic;">Firmware Mitigations</a><span
              style="font-style: italic;">:</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.2.1)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Enhanced Indirect Branch Restricted Speculation
              (</span><span style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">IBRS</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">)</span><span style="font-style: italic;">: Restricts
              speculation of indirect branches.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Ubuntu kernel is compiled with <span style="color: rgb(77, 206, 29); font-weight: bold;">IBRS</span>
            support. Virtual CPU flag <span style="color: rgb(166, 0, 196); font-weight: bold;">spec-ctrl</span> should
            be used to advertise <span style="font-weight: bold; color: rgb(166, 0, 196);">ibrs </span>capability to
            Virtual Machine Guests.
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.2.2)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Single Thread Indirect Branch Predictors
              (</span><span style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">STIBP</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">)</span><span style="font-style: italic;">: Prevents
              indirect branch predictions from being controlled by the sibling HW thread.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Virtual CPU flag <span style="font-weight: bold; color: rgb(166, 0, 196);">stipb </span>COULD be used to
            advertise the <span style="color: rgb(166, 0, 196); font-weight: bold;">stipb</span><span
              style="font-weight: bold;"> </span>capability to Virtual Machine Guests, but <span
              style="color: rgb(166, 0, 196); font-weight: bold;">spec-ctrl</span> &amp; <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ibpb</span><span
              style="color: rgb(166, 0, 196);"> </span>CPU capabilities are enough - and have better performance - to
            also mitigate <span style="color: rgb(77, 206, 29); font-weight: bold;">STIBP</span>. </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.2.3)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Indirect Branch Predictor Barrier (</span><span
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">IBPB</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">)</span><span style="font-style: italic;">: Ensures
              earlier code's behavior does not control later indirect branch predictions. Complements Enhanced
              IBRS.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Ubuntu kernel is compiled with <span style="color: rgb(77, 206, 29); font-weight: bold;">IBPB</span>
            support. Virtual CPU flag <span style="color: rgb(166, 0, 196); font-weight: bold;">ibpb</span><span
              style="color: rgb(166, 0, 196);"> </span>should be used to advertise <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ibpb</span><span
              style="color: rgb(166, 0, 196);"> </span>capabilities to Virtual Machine Guests.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-5754.html">CVE-2017-5754</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown"
              style="color: rgb(255, 0, 0);">Rogue Data Cache Load (Variant 3 / Meltdown)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">c.1) Kernel Mitigation: </span><a
              href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation"
              style="color: rgb(77, 206, 29); font-style: italic;">Kernel Page Table Isolation (</a><a
              href="https://en.wikipedia.org/wiki/Kernel_page-table_isolation"
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">KPTI</a>) </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Meltdown flaw <span style="text-decoration-line: underline;">does not allow a
              malicious guest to read the contents of hypervisor memory</span>. Fixing it only requires that the
            operating system separates the user and kernel address spaces (known as <span
              style="font-weight: bold;">page table isolation</span>), which can be done separately on the host and the
            guests (already covered in previous section).</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>Because the cost of <span style="color: rgb(77, 206, 29); font-weight: bold;">Kernel Page Table
              Isolation</span> is high, it is
            recommended to advertise the <span style="color: rgb(166, 0, 196); font-weight: bold;">pcid</span> CPU
            feature to guests, so they can mitigate the cost of the Meltdown fix with this feature.</font>
        </div>
        <div>
          <br>
        </div>
        <ul>
          <li>
            <div><span style="font-weight: bold;">
                <font>CPU flags to advertise CPUs (or Microcodes) have mitigations</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 3 additional <span style="font-weight: bold;">CPU flags</span>
            associated with Spectre/Meltdown mitigation:</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><b>
                  <font color="#A600C4">spec-ctrl</font>
                </b>        <font color="#4DCE1D">Indirect Branch Restricted Speculation (<b>IBRS</b>)</font>
              </font>
            </div>
            <div>
              <font><b>
                  <font color="#A600C4">ibpb             </font>
                </b>
                <font color="#4DCE1D">Indirect Branch Prediction Barrier (<b>IBPB</b>)</font>
              </font>
            </div>
            <div>
              <font><b style="color: rgb(166, 0, 196);">pcid</b>
                <font color="#4DCE1D">             Process Context Identifiers (<b>PCID</b>)</font>
              </font>
            </div>
          </div>
        </div>
        <div></div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>AMD x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">ibpb             </span><span
                  style="color: rgb(77, 206, 29);">Indirect Branch Prediction
                  Barrier (</span><span style="color: rgb(77, 206, 29); font-weight: bold;">IBPB</span><span
                  style="color: rgb(77, 206, 29);">)</span></font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>These flags expose additional functionality made available through new
            microcode updates for certain Intel/AMD processors that can be used to mitigate various attack vectors
            related to Spectre. Having those flags mean you're mitigated through CPU and/or CPU microcodes.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>pseries</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 3 tri-state-machine options/capabilities relating to Spectre/Meltdown
            mitigation:</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><b>
                  <font color="#A600C4">cap-cfpc</font>
                </b>         <font color="#4DCE1D">Cache Flush on Privilege Change</font>
              </font>
            </div>
            <div>
              <font><b>
                  <font color="#A600C4">cap-sbbc</font>
                </b>         <font color="#4DCE1D">Speculation Barrier Bounds Checking</font>
              </font>
            </div>
            <div>
              <font><b>
                  <font color="#A600C4">cap-ibs</font>
                </b>          <font color="#4DCE1D">Indirect Branch Serialisation</font>
              </font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Again, having those mean you're mitigated through CPU and/or CPU microcodes.
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">s390x</span> </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 2 CPU feature bits relating to Spectre/Meltdown:</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><b>
                  <font color="#A600C4">bpb              </font>
                </b>
                <font color="#4DCE1D">Branch Prediction Blocking</font>
              </font>
            </div>
            <div>
              <font><b>
                  <font color="#A600C4">ppa15            </font>
                </b>
                <font color="#4DCE1D">PPA15 is installed</font>
              </font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>A CPU having those flags possibly mean you're mitigated through CPU and/or CPU
            microcodes. Instead of trying to map one or another, check last session of this document for the
            vulnerability scanner.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Check</span> <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/MitigationControls"
              style="color: rgb(168, 168, 168);">Spectre and Meltdown Mitigation Controls</a> <span
              style="color: rgb(168, 168, 168);">to understand how to opt in or out from existing mitigations, or how to
              let the Host (or Guest) kernel to decide which mitigation to use. That's why its important to understand
              existing CPU flags and why they should be passed correctly to VMs: to let Guest kernels to decide the
              best, and likely most performant, mitigation available for a vulnerability.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ol start="2" style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Others</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div></div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Vulnerabilities (CVEs) &amp; Mitigation Notes</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3665.html">CVE-2018-3665</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/LazyFP" style="color: rgb(255, 0, 0);">Lazy FP
              Save/Restore (LazyFP)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">a.1)</span> <span style="font-style: italic;">Kernel Mitigation</span>
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>No particular mitigation needed for QEMU/KVM. Guests kernels would ALSO have to
            make sure to use <a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00145.html"
              style="color: rgb(77, 206, 29);">Eager FP Save Restore</a> instead of Lazy, OR check if <span
              style="color: rgb(166, 0, 196); font-weight: bold;">xsaveopt</span><span
              style="color: rgb(166, 0, 196);"> </span>CPU feature is available for the vCPUs, which would be already
            enough not to suffer from this vulnerability.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3693.html">CVE-2018-3693</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BCBS" style="color: rgb(255, 0, 0);">Bounds
              Check
              Bypass Store (Variant (or Spectre) 1.1 and 1.2 / BCBS)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>b.1) Software Based Mitigations</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.1.1)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Process Isolation</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>N/A</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.1.2)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">LFENCE</span> <span
              style="font-style: italic;">(requires new firmware/microcode)</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>N/A</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">b.2) Firmware Mitigation:</span> <span
              style="color: rgb(77, 206, 29);">Speculative Store Bypass Disable (SSBD)</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>N/A</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <div></div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3640.html">CVE-2018-3640</a>
            - <span style="color: rgb(255, 0, 0);">Rogue System Register Read (RSRE / Variant 3a)</span></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>c.1) Firmware Mitigation.</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>N/A</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>d) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3639.html">CVE-2018-3639</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Variant4"
              style="color: rgb(255, 0, 0);">Speculative Store Bypass (SSB / Variant 4 / Spectre-NG)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>d.1) <span style="font-style: italic;">Firmware Mitigation:</span> <a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00115.html"
              style="color: rgb(77, 206, 29);">Speculative Store Bypass Disable (</a><a
              href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00115.html"
              style="color: rgb(77, 206, 29); font-weight: bold;">SSBD</a>)</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold; color: rgb(77, 206, 29);">SSBD</span> prevents
            a load from executing speculatively until the address of all older stores are known. If CPU/Microcode
            supports it, the CPU flag should be advertised to virtual machines.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The CPU feature <span style="color: rgb(166, 0, 196); font-weight: bold;">ssbd</span><span
              style="color: rgb(166, 0, 196);"> </span>should be advertised to virtual CPUs so Virtual Machine Guests
            know that disabling Speculative Store Bypass (<span style="font-weight: bold;">SSB</span>) is possible. Like
            explained in the previous session of this document, <span
              style="font-weight: bold; color: rgb(77, 206, 29);">SSBD</span> can be enabled/disabled through seccomp or
            prctl.</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>CPU flags to advertise CPUs (or Microcodes) have mitigations</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 1 additional CPU flags associated with Spectre/Meltdown mitigation:
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">ssbd</span><span>             </span><span
                  style="color: rgb(77, 206, 29);">Speculative Store Bypass
                  Disable (<b>SSBD</b>)</span></font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Requires the host CPU microcode to support this feature before it can be used
            for guest CPUs.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>AMD x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 2 additional <span style="color: rgb(166, 0, 196); font-weight: bold;">CPU flags</span>
            associated with Spectre/Meltdown
            mitigation:</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">virt-ssbd</span><span>        </span><span
                  style="color: rgb(77, 206, 29);">Speculative Store Bypass
                  Disable (lower performance)</span></font>
            </div>
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">amd-ssbd</span><span
                  style="color: rgb(166, 0, 196);">         </span><span>
                  <font color="#4DCE1D">Speculative Store Bypass Disable (best performance)</font>
                </span></font>
            </div>
            <div><span>
                <font><b>
                    <font color="#A600C4">amd-no-ssb</font>
                  </b>
                  <font color="#4DCE1D">       Host is not vulnerable to Variant 4 (future CPUs)</font>
                </font>
              </span></div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold; color: rgb(166, 0, 196);">virt-ssbd</span>
            provides a lower performance than <span style="font-weight: bold; color: rgb(166, 0, 196);">amd-ssbd</span>
            but both should be provided to virtual machines for compatibility reasons, as some of virtual machines might
            not support <span style="font-weight: bold; color: rgb(166, 0, 196);">amd-ssbd</span> and will have to stick
            with <span style="font-weight: bold; color: rgb(166, 0, 196);">virt-ssbd</span> mitigation.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Check</span> <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/SpectreAndMeltdown/MitigationControls"
              style="color: rgb(168, 168, 168);">Spectre and Meltdown Mitigation Controls</a> <span
              style="color: rgb(168, 168, 168);">to understand how to choose the best way to enable the</span> <span
              style="color: rgb(77, 206, 29); font-weight: bold;">SSBD</span> <span
              style="color: rgb(168, 168, 168);">(disable by default, opt-in via prctl() ? seccomp implicitly opt-in
              with prctl() enabled threads ? All enabled ?</span> <span
              style="color: rgb(77, 206, 29); font-weight: bold;">SSBD</span> <span
              style="color: rgb(168, 168, 168);">disabled ?). </span><span style="color: rgb(168, 168, 168);">By
              informing the VM Guests about the</span> <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ssbd</span><span
              style="color: rgb(166, 0, 196);"> </span><span style="color: rgb(168, 168, 168);">CPU feature, they might
              opt in or out this mitigation also.</span></font>
        </div>
        <div>
          <font color="#A8A8A8" style="font-size: 11pt;"><br /></font>
        </div>
        <div>
          <font>NOTE: When ENABLING <span style="font-weight: bold; color: rgb(77, 206, 29);">SSBD </span>you're
            actually DISABLING the CPU SSB
            feature (Speculative Store Bypass), which is where the vulnerability relies. When passing the <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ssbd</span><span
              style="color: rgb(166, 0, 196);"> </span>CPU feature, you're just advertising the capability of disabling
            the CPU SSB feature to the guest.</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ol start="3" style="text-align: left;">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html"
                style="font-weight: bold;">
                <font>L1 Terminal Fault (L1TF)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3615.html">CVE-2018-3615</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Intel SGX
              (Software Guard Extensions) (Foreshadow /</a> <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</a><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3620.html">CVE-2018-3620</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Operating
              Systems and System Management Mode (Fault-OS / SMM) (</a><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</a><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">)</a></font>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3646.html">CVE-2018-3646</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0);">Virtualization Extensions (</a><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</a><a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Vulnerabilities (CVEs) &amp; Mitigation Notes</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>Mitigations bellow server for different L1TF vulnerabilities sub-types.
            </font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">3.1) Using Newer CPUs or
              Firmware:</span><span style="color: rgb(77, 206, 29); font-style: italic;"> </span><span
              style="color: rgb(77, 206, 29); font-style: italic;">C</span><span
              style="color: rgb(77, 206, 29); font-style: italic;">heck</span> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-l1-terminal-fault"
              style="color: rgb(77, 206, 29); font-style: italic;">Intel Documentation</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Processors that have the <span style="color: rgb(166, 0, 196); font-weight: bold;">RDCL_NO</span> bit
            set to one (1) in the <span style="color: rgb(166, 0, 196); font-weight: bold;">IA32_ARCH_CAPABILITIES
              MSR</span> are NOT susceptible
            to the <span style="font-weight: bold;">L1TF</span> speculative execution side channel. On such processors,
            none of the following mitigations are required. All virtual machines should be warned about the existence of
            the <span style="color: rgb(166, 0, 196); font-weight: bold;">rdctl-no</span> CPU feature so their kernels
            can opt-out from deeper L1D flushes.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">3.2) Kernel Mitigation:</span> <span
              style="color: rgb(77, 206, 29); font-style: italic;">Removing Secrets from L1D</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font><span style="font-weight: bold;">L1D</span> Flush is supported by Ubuntu Kernel
            and can be &quot;accelerated&quot; by newer CPUs and or Firmwares containing the<span
              style="font-weight: bold;"> </span><span
              style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> <span
              style="color: rgb(166, 0, 196);">CPU feature.</span></font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 120px;">
          <font>The <span style="font-weight: bold;">IA32_FLUSH_CMD MSR</span> is more precise
            and does not flush higher cache levels, thereby limiting its impact only to the L1 cache on the physical
            core executing the flush itself.</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>For Hypervisor Hosts, the <span
              style="color: rgb(166, 0, 196); font-weight: bold;">SKIP_L1DFL_VMENTRY</span> CPU feature,
            from IA32_ARCH_CAPABILITIES MSR, explained in the beginning of this session, also tells the Kernel that
            there is no need to flush the <span style="font-weight: bold;">L1D</span> cache when entering into a vCPU
            context (<span style="font-weight: bold;">VMENTRY</span>), as the CPU is mitigated for <span
              style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</span>.</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;"><span style="font-style: italic;">
            <font>3.3) Page Table Entries Inversion</font>
          </span></div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>N/A (already done by the hypervisor kernel, guest kernel also has to have this
            feature to avoid guest user &lt;-&gt; guest kernel attacks).</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font><span style="font-weight: bold;">Disabling EPT for virtual machines provides
              full mitigation for L1TF even with SMT enabled</span>, because the effective page tables for guests are
            managed and sanitized by the hypervisor. <span style="font-weight: bold;">Though disabling EPT has a
              significant performance impact especially when the Meltdown mitigation KPTI is enabled.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font><span style="font-style: italic;">3.4) SMT Disablement</span></font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>If SMT is not supported by the processor or disabled in the BIOS or by the
            kernel, it's only required to enforce L1D flushing on VM_ENTER.</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>CPU flags to advertise CPUs (or Microcodes) have mitigations</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>There are 2 additional CPU flags associated with L1TF vulnerabilities:</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font style="font-size: 11pt;"><b>
                  <font style="color: rgb(166, 0, 196);">rdctl-no</font>
                </b>              Processor is not susceptible to Rogue Data Cache Load (RDCL)</font>
            </div>
            <div>
              <font><b>
                  <font color="#A600C4">skip-l1dfl-vmentry</font>
                </b>    Skip <b>
                  <font color="#4DCE1D">L1D_FLUSH</font>
                </b> whenever there is a VM_ENTRY</font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Both CPU features come from a another CPU feature available in newer CPUs
            called IA32_ARCH_CAPABILITIES, which is explained in the beginning of this topic (&quot;<span
              style="font-weight: bold;">QEMU/KVM Mitigations and CPU Flags&quot;</span>), responsible to enumerate HW
            mitigations available in newer CPUs. If they're present in your CPU, you should definitely pass them to the
            Virtual Machine Guests, but always thinking about live migrations among Hosts with different CPU types (and
            available CPU features).</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Always flushing the cache will
              negatively impact performance in a manner that's dependent on the workload inside of the virtual machine
              while never flushing the cache will make your system vulnerable to CVE-2018-3646. Use the
              &quot;kvm-intel.vmentry_l1d_flush=always&quot; or &quot;kvm-intel.vmentry_l1d_flush=never&quot; kernel
              command line options to change the default persistently across reboots. Write &quot;always&quot;,
              &quot;cond&quot; (the default), or &quot;never&quot; to /sys/module/kvm_intel/parameters/vmentry_l1d_flush
              to temporarily change the behavior.</span></font>
        </div>
        <div></div>
        <div>
          <font><span style="font-weight: bold; text-decoration-line: underline;">Full
              protection</span> (no minimal realistic leak from L1D cache) from the Hyper-Thread based attack can be
            achieved in one of two ways:</font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>3.1) The first option requires that Hyper-Threads be disabled in the system's
            BIOS, by booting with the &quot;<span style="font-weight: bold;">nosmt</span>&quot; kernel command line
            option, or by writing &quot;<span style="font-weight: bold;">off</span>&quot; or &quot;<span
              style="font-weight: bold;">forceoff</span>&quot; to <span
              style="font-weight: bold;">/sys/devices/system/cpu/smt/control</span> (this file is not persistent across
            reboots).</font>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <br>
        </div>
        <div style="text-align: left; margin-left: 80px;">
          <font>3.2) The second option involves restricting guests to specific CPU cores that
            are not shared with the host or other guests considered to be in different trust domains. This option is
            more difficult to configure and may still allow a malicious guest to gain some information from the host
            environment.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">Check the</span> <a
              href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#mitigation-control-command-line"
              style="color: rgb(168, 168, 168);">Linux Kernel Admin Guide - L1TF Mitigation Control Cmd Line</a><span
              style="color: rgb(168, 168, 168);"> to check if you should do a full L1TF mitigation (disabling SMT and
              enabling unconditional L1D flushing, or disabling SMT and no L1D flushing, or disabling SMT only). Check
              the same document for the KVM module parameters (enabling or not vmentry_l1d_flush, like explained
              previously).</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">Final choice on which mitigations you are
              going to use will depend how much you trust the code running in your virtual machines.</span></font>
        </div>
        <div></div>
        <div></div>
        <ol start="4" style="text-align: left;">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html"
                style="font-weight: bold;">
                <font>Microarchitectural Data Sampling (MDS)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12126.html">CVE-2018-12126</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Store Buffer Data Sampling (MSBDS / Fallout)</a></font>
        </div>
        <div>
          <font>b) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12127.html">CVE-2018-12127</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Load Port Data Sampling (MLPDS / RIDL)</a></font>
        </div>
        <div>
          <font>c) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12130.html">CVE-2018-12130</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Fill Buffer Data Sampling (MFBDS / ZombieLoad)</a>
          </font>
        </div>
        <div>
          <font>d) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-11091.html">CVE-2019-11091</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Data Sampling Uncacheable Memory (MDSUM)</a></font>
        </div>
        <div>
          <br>
        </div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Mitigations for (a), (b), (c) and (d):</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">CASE 01) </span><span
              style="font-weight: bold; text-decoration: underline;">Non SMT (Simultaneous Multithreading)
              CPUs</span><span style="font-weight: bold;">:</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>There are two methods to overwrite the microarchitectural buffers affected by
            MDS: MD_CLEAR functionality and software sequences.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">4.1) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;">Using Newer CPUs or Firmware</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Through IA32_ARCH_CAPABILITIES MSR it is possible to see if the current CPU has
            the <span style="color: rgb(77, 206, 29); font-weight: bold;">RDCL_NO</span> (Not susceptible to Rogue Data
            Cache Load) feature. If it has, then the processor is also not affected by <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MFBDS</span>. With that in mind, passing <span
              style="color: rgb(166, 0, 196); font-weight: bold;">rdctl-no</span><span
              style="color: rgb(166, 0, 196);"> </span><span>CPU feature to the
              virtual machine guest vCPUs is
              appropriate.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Recently IA32_ARCH_CAPABILITIES MSR was expanded to sinalize the <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MDS_NO</span> feature. A value of 1 indicates that
            processor is not affected by <span
              style="color: rgb(255, 0, 0); font-weight: bold;">MFBDS/MSBDS/MLPDS/MDSUM</span>. For this recent CPU
            flag, the vCPU used feature is <span
              style="color: rgb(166, 0, 196); font-weight: bold;">mds-no</span><span>.</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Note that <span style="color: rgb(255, 0, 0); font-weight: bold;">MFBDS</span>
            is mitigated if either the <span style="color: rgb(77, 206, 29); font-weight: bold;">RDCL_NO</span> or <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MDS_NO</span> bit (or both) are set, but not <span
              style="color: rgb(255, 0, 0); font-weight: bold;">MSBDS/MLPDS/MDSUM</span>, those last need MDS_NO
            feature. Some existing processors may also enumerate either <span
              style="color: rgb(77, 206, 29); font-weight: bold;">RDCL_NO</span> or <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MDS_NO </span>only after a microcode update is loaded.
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Intel will release microcode updates and new processors that enumerate <span
              style="color: rgb(77, 206, 29); font-weight: bold;">MD_CLEAR</span> functionality. On processors that
            enumerate <span style="color: rgb(77, 206, 29); font-weight: bold;">MD_CLEAR</span>, the VERW instruction or
            <span style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> command should be used to cause
            the processor to overwrite buffer values that are affected by <span
              style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span>, as these instructions are preferred to the
            software sequences, to mitigate the vulnerabilities.
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">4.1.1)</span> <span
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">MD_CLEAR</span> <span
              style="font-style: italic;">+ QEMU:</span> <span
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">L1D_FLUSH</span> <span
              style="font-style: italic;">support when entering vCPU</span></font>
        </div>
        <div>
          <div>
            <br>
          </div>
          <div>
            <font>The VMM can execute either the VERW instruction or the <span
                style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> command before entering a guest VM.
              This will overwrite protected data in the buffers that could belong to the hypervisor or other VMs.
              Hypervisors that already use the <span
                style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> command before entering guest VMs
              to mitigate L1TF may not need further changes beyond loading a microcode update that enumerates MD_CLEAR.
            </font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font>Some new CPUs might also sinalize the <span
                style="color: rgb(166, 0, 196); font-weight: bold;">SKIP_L1DFL_VMENTRY</span>, which will indicate that
              there is no need for the hypervisor to flush the <span style="font-weight: bold;">L1D</span> cache on a
              <span style="font-weight: bold;">VM_ENTRY</span>.
            </font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font><span style="font-style: italic;">4.1.2)</span> <span
                style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">MD_CLEAR</span> <span
                style="font-style: italic;">+ Kernel Mitigations</span></font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font>N/A</font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font><span style="color: rgb(168, 168, 168); font-style: italic;">4.1.3)</span>
              <span style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">MD_CLEAR</span> <span
                style="color: rgb(168, 168, 168); font-style: italic;">+ System Management Mode (SMM)</span>
            </font>
          </div>
          <div>
            <br>
          </div>
          <div>
            <font>N/A</font>
          </div>
          <div>
            <br>
          </div>
        </div>
        <div>
          <font><span style="font-style: italic;">4.2) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="color: rgb(0, 0, 0); font-style: italic;">NO</a> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="color: rgb(77, 206, 29); font-style: italic; font-weight: bold;">MD_CLEAR</a> <a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="color: rgb(0, 0, 0); font-style: italic;">+ Software Based Mitigation</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">CASE 02) <span
                style="font-weight: bold; text-decoration: underline;">For SMT (</span></span><span
              style="text-decoration: underline; font-weight: bold;">Simultaneous Multithreading) </span><span
              style="text-decoration: underline; font-weight: bold;">capable CPUs</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-style: italic;">4.3) </span><a
              href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling"
              style="font-style: italic;">Sibling threads and OS Mitigations</a></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>4.3.1) HW Disable </font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold;">THE ONLY 100% effective method to prevent the
              sibling thread from inferring data values through MDS</span> is to disable SMT, either through the BIOS,
            or by having the hypervisor kernel to only schedule vCPUs in one of the HW threads. All other methods can't
            guarantee 100% the hypervisor guests won't be able to &quot;sniff&quot; L1D cache from the hypervisor and/or
            another guests.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168); font-style: italic;">4</span><span
              style="color: rgb(168, 168, 168); font-style: italic;">.3.2) Group Scheduling</span></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(168, 168, 168);">N/A</span></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168); font-style: italic;">
            <font>4.3.3) Synchronized Entry</font>
          </span></div>
        <div>
          <br>
        </div>
        <div><span style="color: rgb(168, 168, 168);">
            <font>N/A</font>
          </span></div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>4.3.4) Virtual Machine Manager (VMM)</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>Processors that enumerate <span style="color: rgb(77, 206, 29); font-weight: bold;">MD_CLEAR</span> have
            enhanced the <span style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> command to also
            overwrite the
            microarchitectural structures affected by <span
              style="color: rgb(255, 0, 0); font-weight: bold;">MDS</span>. This can allow VMMs that have mitigated
            <span style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</span> through <span
              style="font-weight: bold;">group scheduling</span> and through using the <span
              style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span> command to also mitigate <span
              style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span>. 
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>The hypervisor mitigation may need to be applied to processors that are not
            affected by <span style="color: rgb(255, 0, 0); font-weight: bold;">L1TF</span> (<span
              style="font-weight: bold; color: rgb(166, 0, 196);">RDCL_NO</span> is set) but are affected by <span
              style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span> (<span
              style="color: rgb(166, 0, 196); font-weight: bold;">MDS_NO</span> is clear). Hypervisor on such processors
            can use VERW instead of the <span style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span>
            command. </font>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: left; margin-left: 120px;">
          <font>VMMs that have implemented the <span style="font-weight: bold;">L1D
              flush</span> using a software sequence should use a VERW instruction to overwrite microarchitectural
            structures affected by <span style="color: rgb(255, 0, 0); font-weight: bold;">MDS</span>.</font>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>CPU flags to advertise CPUs (or Microcodes) have mitigations</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>All the features bellow can be passed to the virtual machine guest vCPUs in
            order to inform about host's HW features for mitigations if not using &quot;cpu
            mode='host-passthrough'&quot; (specially when dealing with minimum CPU features available on hosts and live
            migration issues due to that).</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">mds-no   
                               </span><span>Processor is not
                  susceptible Microarch. Data Sampling (<b>
                    <font color="#FF0000">MDS</font>
                  </b>)</span></font>
            </div>
            <div><span>
                <font><b>
                    <font color="#A600C4">md-clear</font>
                  </b>               <font color="#4DCE1D"><b>L1D_FLUSH</b></font> is available to clean <b>L1D</b>
                  cache (<b>
                    <font color="#4DCE1D">L1D_FLUSH</font>
                  </b>)</font>
              </span></div>
            <div>
              <font><b>
                  <font color="#A600C4">rdctl-no</font>
                </b>               Processor is not susceptible to Rogue Data Cache Load (<b>
                  <font color="#FF0000">RDCL</font>
                </b>)</font>
            </div>
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">skip-l1dfl-vmentry</span><span>   
                   Skip</span> <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span>
                <span>whenever there is a <b>VM_ENTRY</b></span>
              </font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Check <a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">The Linux Kernel
              user's and
              administrator's guide</a> to understand how which CPUs have to have SMT disabled to guarantee they're not
            vulnerable, and why SMT mitigation can't be fully guaranteed when inside a virtual machine. The kernel
            command line allows to control the MDS mitigations at boot time with the option mds=(full|full,nosmt|off).
          </font>
        </div>
        <div>
          <br>
        </div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>QEMU/KVM CPUs Mitigation Flags (New CPUs, Microcode)</font>
          </span></div>
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>and HOWTO Enable Flags inside Guests</font>
          </span></div>
        <hr />
        <div>
          <br>
        </div>
        <ol style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Spectre and Meltdown</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>amd64</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>Generally, for Intel CPUs with updated microcode, <span
              style="color: rgb(166, 0, 196); font-weight: bold;">spec-ctrl</span> will enable both <span
              style="color: rgb(77, 206, 29); font-weight: bold;">IBRS</span> and <span
              style="color: rgb(77, 206, 29); font-weight: bold;">IBPB</span> functionality. For <span
              style="text-decoration: underline;">AMD EPYC</span> processors, <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ibpb</span> can be used to enable <span
              style="color: rgb(77, 206, 29); font-weight: bold;">IBPB</span> specifically, and is thought to be
            sufficient by itself for that particular architecture.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>These flags can be set in a similar manner as other CPU flags, i.e.:</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-x86_64 -cpu qemu64,+spec-ctrl,... ...
            </font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu IvyBridge,+spec-ctrl,... ...
            </font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu EPYC,+ibpb,... ...</font>
          </div>
          <div>
            <font>etc...</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Additionally, for management stacks that lack support for setting specific CPU
            flags, a set of new CPU types have been added which enable the appropriate CPU flags automatically:</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-x86_64 -cpu Nehalem-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Westmere-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu SandyBridge-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu IvyBridge-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Haswell-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Haswell-noTSX-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Broadwell-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Broadwell-noTSX-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Skylake-Client-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu Skylake-Server-IBRS ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu EPYC-IBPB ...</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>With regard to migration compatibility, <span
              style="color: rgb(166, 0, 196); font-weight: bold;">spec-ctrl/ibrs</span> (or the corresponding CPU type)
            should be set the same on both source/target to maintain compatibility. Thus, guests will need to be
            rebooted to make use of the new features.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>pseries</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>All three options, <span style="color: rgb(166, 0, 196); font-weight: bold;">cap-cfpc</span>, <span
              style="color: rgb(166, 0, 196); font-weight: bold;">cap-sbbc</span>, and <span
              style="color: rgb(166, 0, 196); font-weight: bold;">cap-ibs</span> default to “broken” to maintain
            compatibility with previous versions of QEMU and unpatched host kernels. To enable them you must start QEMU
            with the desired mitigation strategy specified explicitly. For example:</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-ppc64 ... \</font>
          </div>
          <div>
            <font>  -machine
              pseries-2.11,cap-cfpc=workaround,cap-sbbc=workaround,cap-ibs=fixed</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>With regard to migration compatibility, setting any of these features to a
            value other than the default, “broken”, will require an identical setting (CPU capability/flag) for that
            option on the source/destination guest. To enable these settings your guests will need to be rebooted at
            some point.</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>s390x</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>Both <span style="color: rgb(166, 0, 196); font-weight: bold;">bpb</span> and
            <span style="color: rgb(166, 0, 196); font-weight: bold;">ppa15</span> are enabled by default when using
            “-cpu host” and when the host kernels supports these facilities. For other CPU models, the flags have to be
            set manually. For example:
          </font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-s390x -M s390-ccw-virtio-2.11 ... \</font>
          </div>
          <div>
            <font>  -cpu zEC12,bpb=on,ppa15=on</font>
          </div>
        </div>
        <div>
          <div>
            <br>
          </div>
          <div>
            <font>With regard to migration, enabling <span
                style="color: rgb(166, 0, 196); font-weight: bold;">bpb</span> or <span
                style="color: rgb(166, 0, 196); font-weight: bold;">ppa15</span> feature flags requires that the
              source/target also has those flags enabled. Since this is enabled by default for ‘-cpu host’ (when
              available on the host), you must ensure that <span
                style="color: rgb(166, 0, 196); font-weight: bold;">bpb</span><span
                style="font-weight: bold;">=off</span><span style="font-weight: bold;">,</span><span
                style="color: rgb(166, 0, 196); font-weight: bold;">ppa15</span><span
                style="font-weight: bold;">=off</span> is used if you wish to maintain migration compatibility with
              existing guests when using ‘-cpu host’, or take steps to reboot guests with <span
                style="color: rgb(166, 0, 196); font-weight: bold;">bpb</span><span
                style="font-weight: bold;">/</span><span
                style="color: rgb(166, 0, 196); font-weight: bold;">ppa15</span> enabled prior to migration.</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div></div>
        <ol start="2" style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>Side Channel Attacks - Others</font>
              </span></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3665.html">CVE-2018-3665</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/LazyFP" style="color: rgb(255, 0, 0);">Lazy FP
              Save/Restore (LazyFP)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3693.html">CVE-2018-3693</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/BCBS" style="color: rgb(255, 0, 0);">Bounds
              Check
              Bypass Store (Variant (or Spectre) 1.1 and 1.2 / BCBS)</a></font>
        </div>
        <div></div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3640.html">CVE-2018-3640</a>
            - <span style="color: rgb(255, 0, 0);">Rogue System Register Read (RSRE / Variant 3a)</span></font>
        </div>
        <div>
          <font>d) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3639.html">CVE-2018-3639</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/Variant4"
              style="color: rgb(255, 0, 0);">Speculative Store Bypass (SSB / Variant 4 / Spectre-NG)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Check if <span style="color: rgb(166, 0, 196); font-weight: bold;">xsaveopt</span><span
              style="color: rgb(166, 0, 196);"> </span>CPU feature is available for the vCPUs, which would be already
            enough not to suffer from this vulnerability.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="color: rgb(77, 206, 29); font-weight: bold;">SSBD</span> prevents
            a load from executing speculatively until the address of all older stores are known. The CPU feature <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ssbd</span><span
              style="color: rgb(166, 0, 196);"> </span>should be advertised to virtual CPUs so Virtual Machine Guests
            know that disabling Speculative Store Bypass (<span style="font-weight: bold;">SSB</span>) is possible. 
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Like explained in the previous session of this document, <span
              style="color: rgb(77, 206, 29); font-weight: bold;">SSBD</span> can be enabled/disabled through seccomp or
            prctl for OS processes, and VM guests. By having the <span
              style="color: rgb(166, 0, 196); font-weight: bold;">ssbd</span><span
              style="color: rgb(166, 0, 196);"> </span>capability in its vCPUs, will be also able to enable/disable
            <span style="font-weight: bold;">SSB</span>.
          </font>
        </div>
        <div>
          <br>
        </div>
        <ul style="text-align: left;">
          <li>
            <div><span style="font-weight: bold;">
                <font>CPU flags to advertise CPUs (or Microcodes) have mitigations</font>
              </span></div>
          </li>
        </ul>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-x86_64 -cpu qemu64,+ssbd,... ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu IvyBridge,+ssbd,... ...</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>AMD x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>qemu-system-x86_64 -cpu qemu64,+virt-ssbd,... ...
            </font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu qemu64,+virt-ssbd,+amd-ssbd...
              ...</font>
          </div>
          <div>
            <font>qemu-system-x86_64 -cpu qemu64,+amd-no-ssb,... ...
            </font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <ol start="3" style="text-align: left;">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html"
                style="font-weight: bold;">
                <font>L1 Terminal Fault (L1TF)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3615.html">CVE-2018-3615</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Intel SGX
              (Software Guard Extensions) (Foreshadow / L1TF)</a></font>
        </div>
        <div>
          <font>b) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3620.html">CVE-2018-3620</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF" style="color: rgb(255, 0, 0);">Operating
              Systems and System Management Mode (Fault-OS / SMM) (L1TF)</a></font>
        </div>
        <div>
          <font>c) <a href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-3646.html">CVE-2018-3646</a>
            - <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF"
              style="color: rgb(255, 0, 0);">Virtualization Extensions (L1TF)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span
                  style="font-weight: bold; color: rgb(166, 0, 196);">rdctl-no</span><span>              Processor is
                  not susceptible to Rogue
                  Data Cache Load (RDCL)</span></font>
            </div>
            <div>
              <font><span
                  style="font-weight: bold; color: rgb(166, 0, 196);">skip-l1dfl-vmentry</span><span>    Skip</span>
                <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span>
                <span>whenever there is a VM_ENTRY</span>
              </font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Both CPU features come from a another CPU feature available in newer CPUs
            called IA32_ARCH_CAPABILITIES, which is explained in the beginning of this topic (&quot;<span
              style="font-weight: bold;">QEMU/KVM Mitigations and CPU Flags&quot;</span>), responsible to enumerate HW
            mitigations available in newer CPUs. If they're present in your CPU, you should definitely pass them to the
            Virtual Machine Guests, but always thinking about live migrations among Hosts with different CPU types (and
            available CPU features).</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div><span>
              <font>qemu-system-x86_64 -cpu qemu64,+arch-capabilities,+rdctl-no,... ...</font>
            </span></div>
          <div><span>
              <font>qemu-system-x86_64 -cpu qemu64,+arch-capabilities,+skip-l1dfl-vmentry...
                ...</font>
            </span></div>
          <div><span>
              <font>qemu-system-x86_64 -cpu
                qemu64,+arch-capabilities,+rdctl-no,+skip-l1dfl-vmentry,... ...</font>
            </span></div>
        </div>
        <div>
          <br>
        </div>
        <ol start="4" style="text-align: left;">
          <li>
            <div><a href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html"
                style="font-weight: bold;">
                <font>Microarchitectural Data Sampling (MDS)</font>
              </a></div>
          </li>
        </ol>
        <div>
          <br>
        </div>
        <div>
          <font>a) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12126.html">CVE-2018-12126</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Store Buffer Data Sampling (MSBDS / Fallout)</a></font>
        </div>
        <div>
          <font>b) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12127.html">CVE-2018-12127</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Load Port Data Sampling (MLPDS / RIDL)</a></font>
        </div>
        <div>
          <font>c) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-12130.html">CVE-2018-12130</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Fill Buffer Data Sampling (MFBDS / ZombieLoad)</a>
          </font>
        </div>
        <div>
          <font>d) <a
              href="https://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-11091.html">CVE-2019-11091</a> - <a
              href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/MDS"
              style="color: rgb(255, 0, 0);">Microarchitectural Data Sampling Uncacheable Memory (MDSUM)</a></font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Intel x86 hosts</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <div
            style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">mds-no   
                               </span><span>Processor is not
                  susceptible Microarch. Data Sampling (</span><span
                  style="font-weight: bold; color: rgb(255, 0, 0);">MDS</span><span>)</span></font>
            </div>
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">md-clear</span><span>             
                   </span><span style="color: rgb(77, 206, 29); font-weight: bold;">L1D_FLUSH</span>
                <span>is available to clean</span> <span style="font-weight: bold;">L1D</span> <span>cache (</span><span
                  style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span><span>)</span>
              </font>
            </div>
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">rdctl-no</span><span>             
                   Processor is not susceptible to Rogue
                  Data Cache Load (</span><span
                  style="font-weight: bold; color: rgb(255, 0, 0);">RDCL</span><span>)</span></font>
            </div>
            <div>
              <font><span style="font-weight: bold; color: rgb(166, 0, 196);">skip-l1dfl-vmentry</span><span>   
                   Skip</span> <span style="font-weight: bold; color: rgb(77, 206, 29);">L1D_FLUSH</span>
                <span>whenever there is a</span> <span style="font-weight: bold;">VM_ENTRY</span>
              </font>
            </div>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>All the features bellow can be passed to the virtual machine guest vCPUs in
            order to inform about host's HW features for mitigations if not using &quot;cpu
            mode='host-passthrough'&quot;. Together with L1DFL HW mitigations, MDS HW mitigations are also informed
            through the IA32_ARCH_CAPABILITIES feature.</font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div><span>
              <font>qemu-system-x86_64 -cpu qemu64,+arch-capabilities,+mds-no,... ...</font>
            </span></div>
          <div><span>
              <font>qemu-system-x86_64 -cpu qemu64,+arch-capabilities,+md-clear... ...</font>
            </span></div>
          <div>
            <font>qemu-system-x86_64 -cpu
              qemu64,+arch-capabilities,+rdctl-no,+skip-l1dfl-vmentry,... ...</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div style="text-align: center;">
          <font>&lt; TODO: FINISH LIBVIRT XML EXAMPLES &gt;</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Libvirt examples for Ubuntu Bionic and Disco</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>&lt;qemu:arg
            value='Cascadelake-Server,ss=on,vmx=on,hypervisor=on,tsc_adjust=on,umip=on,pku=on,md-clear=on,stibp=on,arch-capabilities=on,xsaves=on,invtsc=on,rdctl-no=on,ibrs-all=on,skip-l1dfl-vmentry=on,mds-no=on'/&gt;
          </font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Libvirt examples for Ubuntu Eoan and Focal</font>
          </span></div>
        <div>
          <br>
        </div>
        <hr />
        <div style="text-align: center;"><span style="font-weight: bold;">
            <font>Spectre and Meltdown mitigation detection tool</font>
          </span></div>
        <hr />
        <div>
          <br>
        </div>
        <div>
          <font>There are different tools that can be used to detect these vulnerabilities in
            an environment (Architecture, CPU, Firmware Levels, OS Kernel, Hypervisor Types and Versions) AND to show
            you if all of them are mitigated or not.</font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>A very good one that can be used is: <a
              href="https://github.com/speed47/spectre-meltdown-checker">https://github.com/speed47/spectre-meltdown-checker</a>
          </font>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font>Bellow you will find this tools output from a Cascade Lake CPU Server. Note
            that this document tried to explain all its acronyms for CPU Vulnerabilities and/or Mitigation Techniques
            above, so do search this document for an acronym found at the tool output if you need further explanation.
          </font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-style: italic;">
            <font>TIP: I'd run the tool in the Hypervisor Host AND inside the VM OS, to make
              sure that both, the Host and the Guest have all mitigations in place. With the information provided in
              previous section of this document (QEMU/KVM Guests HW Mitigations) you will be able to make sure you're
              correctly advertising your REAL CPU Mitigation Flags into your Guests (so their OS can choose better
              technique for each of the vulnerabilities).</font>
          </span></div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>Spectre and Meltdown mitigation detection tool v0.42-1-g91d0699</font>
          </span></div>
        <div>
          <br>
        </div>
        <div>
          <font>Checking for vulnerabilities on current system Kernel is Linux</font>
        </div>
        <div>
          <font>4.18.0-23-generic #24~18.04.1-Ubuntu SMP Thu Jun 13 17:08:52 UTC 2019 x86_64
          </font>
        </div>
        <div>
          <font>CPU is Intel(R) Xeon(R) Gold 6252 CPU @ 2.10GHz</font>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold; text-decoration: underline;">
            <font>Hardware check</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Hardware support (CPU microcode) for mitigation
              techniques</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Indirect Branch Restricted Speculation (IBRS)
            </font>
          </div>
          <div>
            <font>    * SPEC_CTRL MSR is available: YES</font>
          </div>
          <div>
            <font>    * CPU indicates IBRS capability: YES (SPEC_CTRL
              feature bit)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Indirect Branch Prediction Barrier (IBPB)</font>
          </div>
          <div>
            <font>    * PRED_CMD MSR is available: YES</font>
          </div>
          <div>
            <font>    * CPU indicates IBPB capability: YES (SPEC_CTRL
              feature bit)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Single Thread Indirect Branch Predictors (STIBP)
            </font>
          </div>
          <div>
            <font>    * SPEC_CTRL MSR is available: YES</font>
          </div>
          <div>
            <font>    * CPU indicates STIBP capability: YES (Intel STIBP
              feature bit)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Speculative Store Bypass Disable (SSBD)</font>
          </div>
          <div>
            <font>    * CPU indicates SSBD capability: YES (Intel SSBD)
            </font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * L1 data cache invalidation</font>
          </div>
          <div>
            <font>    * FLUSH_CMD MSR is available: YES</font>
          </div>
          <div>
            <font>    * CPU indicates L1D flush capability: YES (L1D
              flush feature bit)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Microarchitecture Data Sampling</font>
          </div>
          <div>
            <font>    * VERW instruction is available: YES (MD_CLEAR
              feature bit)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Enhanced IBRS (IBRS_ALL)</font>
          </div>
          <div>
            <font>    * CPU indicates ARCH_CAPABILITIES MSR availability:
              YES</font>
          </div>
          <div>
            <font>    * ARCH_CAPABILITIES MSR advertises IBRS_ALL
              capability: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU explicitly indicates not being vulnerable to
              Meltdown/L1TF (RDCL_NO): YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU explicitly indicates not being vulnerable to
              Variant 4 (SSB_NO): NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU/Hypervisor indicates L1D flushing is not
              necessary on this system: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * Hypervisor indicates host CPU might be vulnerable
              to RSB underflow (RSBA): NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU explicitly indicates not being vulnerable to
              Microarchitectural Data Sampling (MDS_NO): YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU supports Software Guard Extensions (SGX): NO
            </font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU microcode is known to cause stability problems:
              NO</font>
          </div>
          <div>
            <font>    (model 0x55 family 0x6 stepping 0x6 ucode 0x4000021
              cpuid 0x50656)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>  * CPU microcode is the latest known available
              version: NO</font>
          </div>
          <div>
            <font>    (latest version is 0x4000024 dated 2019/04/07
              according to builtin MCExtractor DB v112 - 2019/05/22)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div>
          <font><span style="font-weight: bold; text-decoration: underline;">CPU
              vulnerability</span> <span style="font-weight: bold;">to the speculative execution attack variants</span>
          </font>
        </div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>  * Vulnerable to CVE-2017-5753 (Spectre Variant 1,
              bounds check bypass): YES</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2017-5715 (Spectre Variant 2,
              branch target injection): YES</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2017-5754 (Variant 3, Meltdown,
              rogue data cache load): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-3640 (Variant 3a, rogue
              system register read): YES</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-3639 (Variant 4, speculative
              store bypass): YES</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-3615 (Foreshadow (SGX), L1
              terminal fault): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-3620 (Foreshadow-NG (OS), L1
              terminal fault): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-3646 (Foreshadow-NG (VMM),
              L1 terminal fault): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-12126 (Fallout,
              microarchitectural store buffer data sampling (MSBDS)): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-12130 (ZombieLoad,
              microarchitectural fill buffer data sampling (MFBDS)): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2018-12127 (RIDL,
              microarchitectural load port data sampling (MLPDS)): NO</font>
          </div>
          <div>
            <font>  * Vulnerable to CVE-2019-11091 (RIDL,
              microarchitectural data sampling uncacheable memory (MDSUM)): NO</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2017-5753 aka 'Spectre Variant 1, bounds check bypass'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES
              (Mitigation: __user pointer sanitization)</font>
          </div>
          <div>
            <font>* Kernel has array_index_mask_nospec: YES (1 occurrence
              found of x86 64 bits array_index_mask_nospec())</font>
          </div>
          <div>
            <font>* Kernel has the Red Hat/Ubuntu patch: NO</font>
          </div>
          <div>
            <font>* Kernel has mask_nospec64 (arm64): NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (Mitigation: __user pointer
              sanitization)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2017-5715 aka 'Spectre Variant 2, branch target injection'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES</font>
          </div>
          <div>
            <font> (Mitigation: Enhanced IBRS, IBPB: conditional, RSB
              filling)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>* Mitigation 1</font>
          </div>
          <div>
            <font>  * Kernel is compiled with IBRS support: YES</font>
          </div>
          <div>
            <font>    * IBRS enabled and active: YES</font>
          </div>
          <div>
            <font>  * Kernel is compiled with IBPB support: YES</font>
          </div>
          <div>
            <font>    * IBPB enabled and active: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>* Mitigation 2</font>
          </div>
          <div>
            <font>  * Kernel has branch predictor hardening (arm): NO
            </font>
          </div>
          <div>
            <font>  * Kernel compiled with retpoline option: YES</font>
          </div>
          <div>
            <font>  * Kernel supports RSB filling: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (IBRS + IBPB are mitigating
              the vulnerability)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2017-5754 aka 'Variant 3, Meltdown, rogue data cache load'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports Page Table Isolation (PTI): YES
            </font>
          </div>
          <div>
            <font>  * PTI enabled and active: NO</font>
          </div>
          <div>
            <font>  * Reduced performance impact of PTI: YES </font>
          </div>
          <div>
            <font>    (CPU supports INVPCID, performance impact of PTI
              will be greatly reduced)</font>
          </div>
          <div>
            <font>* Running as a Xen PV DomU: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-3640 aka 'Variant 3a, rogue system register read'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* CPU microcode mitigates the vulnerability: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU microcode
              mitigates the vulnerability)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-3639 aka 'Variant 4, speculative store bypass'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES</font>
          </div>
          <div>
            <font>  (Mitigation: Speculative Store Bypass disabled via
              prctl and seccomp)</font>
          </div>
          <div>
            <font>* Kernel supports disabling speculative store bypass
              (SSB): YES (found in /proc/self/status)</font>
          </div>
          <div>
            <font>* SSB mitigation is enabled and active: YES (per-thread
              through prctl)</font>
          </div>
          <div>
            <font>* SSB mitigation currently active for selected
              processes: YES</font>
          </div>
          <div>
            <font>  (systemd-journald systemd-logind systemd-networkd
              systemd-resolved systemd-timesyncd systemd-udevd)</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (Mitigation: Speculative
              Store Bypass disabled via prctl and seccomp)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-3615 aka 'Foreshadow (SGX), L1 terminal fault'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* CPU microcode mitigates the vulnerability: N/A</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-3620 aka 'Foreshadow-NG (OS), L1 terminal fault'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports PTE inversion: YES (found in kernel
              image)</font>
          </div>
          <div>
            <font>* PTE inversion enabled and active: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-3646 aka 'Foreshadow-NG (VMM), L1 terminal fault'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Information from the /sys interface: Not affected
            </font>
          </div>
          <div>
            <font>* This system is a host running a hypervisor: YES
            </font>
          </div>
          <div>
            <font>* Mitigation 1 (KVM)</font>
          </div>
          <div>
            <font>  * EPT is disabled: NO</font>
          </div>
          <div>
            <font>* Mitigation 2</font>
          </div>
          <div>
            <font>  * L1D flush is supported by kernel: YES (found
              flush_l1d in /proc/cpuinfo)</font>
          </div>
          <div>
            <font>  * L1D flush enabled: NO</font>
          </div>
          <div>
            <font>  * Hardware-backed L1D flush supported: YES
              (performance impact of the mitigation will be greatly reduced)</font>
          </div>
          <div>
            <font>  * Hyper-Threading (SMT) is enabled: YES</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-12126 aka 'Fallout, microarchitectural store buffer data sampling
              (MSBDS)'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports using MD_CLEAR mitigation: YES
              (md_clear found in /proc/cpuinfo)</font>
          </div>
          <div>
            <font>* Kernel mitigation is enabled and active: NO</font>
          </div>
          <div>
            <font>* SMT is either mitigated or disabled: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-12130 aka 'ZombieLoad, microarchitectural fill buffer data sampling
              (MFBDS)'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports using MD_CLEAR mitigation: YES
              (md_clear found in /proc/cpuinfo)</font>
          </div>
          <div>
            <font>* Kernel mitigation is enabled and active: NO</font>
          </div>
          <div>
            <font>* SMT is either mitigated or disabled: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2018-12127 aka 'RIDL, microarchitectural load port data sampling (MLPDS)'
            </font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports using MD_CLEAR mitigation: YES
              (md_clear found in /proc/cpuinfo)</font>
          </div>
          <div>
            <font>* Kernel mitigation is enabled and active: NO</font>
          </div>
          <div>
            <font>* SMT is either mitigated or disabled: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
        <div><span style="font-weight: bold;">
            <font>CVE-2019-11091 aka 'RIDL, microarchitectural data sampling uncacheable memory
              (MDSUM)'</font>
          </span></div>
        <div>
          <br>
        </div>
        <div
          style="box-sizing: border-box; padding: 8px;color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;">
          <div>
            <font>* Mitigated according to the /sys interface: YES (Not
              affected)</font>
          </div>
          <div>
            <font>* Kernel supports using MD_CLEAR mitigation: YES
              (md_clear found in /proc/cpuinfo)</font>
          </div>
          <div>
            <font>* Kernel mitigation is enabled and active: NO</font>
          </div>
          <div>
            <font>* SMT is either mitigated or disabled: NO</font>
          </div>
          <div>
            <font><br /></font>
          </div>
          <div>
            <font>&gt; STATUS: NOT VULNERABLE (your CPU vendor reported
              your CPU model as not vulnerable)</font>
          </div>
        </div>
        <div>
          <br>
        </div>
      </div>
      <div><br /></div>
    </span>
  </div>
</body>

</html>
